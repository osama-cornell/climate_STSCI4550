else if(df[i,col1] >= 335){
df[i,col2] <- 12
}
}
return(df)
}
df <- cat_day(df,"min_day","cat_min")
df <- cat_day(df,"max_day","cat_max")
df$cat_min <- factor(df$cat_min)
df$cat_max <- factor(df$cat_max)
category_colors <- c("red", "blue", "green", "orange", "purple", "pink",
"black","gray","brown","yellow",
"darkblue","cyan","magenta")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = cat_min)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = cat_max)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
grid <- grid_points(0.75)
preds <- station_grid_points(df,grid,"min_day")
preds["cat_min"] <- rep(NA,dim(preds)[1])
preds$AVERAGE <- round(preds$AVERAGE)
preds <- cat_day(preds,"AVERAGE","cat_min")
preds$cat_min <- factor(preds$cat_min)
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = cat_min)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
grid <- grid_points(0.75)
preds <- station_grid_points(df,grid,"max_day")
preds["cat_max"] <- rep(NA,dim(preds)[1])
preds$AVERAGE <- round(preds$AVERAGE)
preds <- cat_day(preds,"AVERAGE","cat_max")
preds$cat_min <- factor(preds$cat_max)
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = cat_min)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = "cat_min")) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = "cat_min")) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = cat_min)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = "cat_min")) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = cat_min)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
a <- "df"
as.name(a)
b <- as.name(a)
#Problem 1
new_df <- weather_data %>% filter(LONGITUDE > -130) %>% filter(LONGITUDE < 0)
stations <- unique(new_df$WBANNO)
df <- time_series(station_id = stations[1], start = "2024-03-01",
end = "2024-03-30")
for(station in stations[2:length(stations)]){
ts <- time_series(station_id = station, start = "2024-03-01",
end = "2024-03-30")
df <- rbind(df,ts)
}
average_df <- df %>% group_by(WBANNO) %>%
summarize(LONGITUDE = unique(LONGITUDE), LATITUDE = unique(LATITUDE),
AVERAGE = mean(T_DAILY_AVG, na.rm = TRUE)) %>% select(-WBANNO)
average_df <- na.omit(average_df)
plot_interpolations(df = average_df,col1 = "AVERAGE")
plot_interpolations(df = average_df,col1 = AVERAGE)
plot_interpolations(df = average_df,col1 = average_df$AVERAGE)
#Problem 2
grid <- grid_points(0.75)
preds <- station_grid_points(df,grid)
plot_interpolations(preds)
plot_interpolations(df = preds, col1 = preds$AVERAGE)
#Problem 3
df <- data.frame(WBANNO = c(), LONGITUDE = c(), LATITUDE = c(), min = c(),
max = c() , min_day = c(), max_day = c())
for(station in stations){
cycle <- yearly_cycle(station)
min <- min(cycle$temp)
max <- max(cycle$temp)
min_day <- which.min(cycle$temp)
max_day <- which.max(cycle$temp)
new_df <- weather_data %>% filter(WBANNO == station)
LONGITUDE <- unique(new_df$LONGITUDE)
LATITUDE <- unique(new_df$LATITUDE)
result <- cbind(station,LONGITUDE,LATITUDE,min,max,min_day,max_day)
df <- rbind(df,result)
}
df["cat_min"] <- rep(NA,dim(df)[1])
df["cat_max"] <- rep(NA, dim(df)[1])
cat_day <- function(df,col1,col2){
for(i in 1:dim(df)[1]){
if(df[i,col1] <= 31){
df[i,col2] <- 1
}
else if(df[i,col1] >= 32 && df[i,col1] <= 59){
df[i,col2] <- 2
}
else if(df[i,col1] >= 60 && df[i,col1] <= 90){
df[i,col2] <- 3
}
else if(df[i,col1] >= 91 && df[i,col1] <= 120){
df[i,col2] <- 4
}
else if(df[i,col1] >= 121 && df[i,col1] <= 151){
df[i,col2] <- 5
}
else if(df[i,col1] >= 152 && df[i,col1] <= 181){
df[i,col2] <- 6
}
else if(df[i,col1] >= 182 && df[i,col1] <= 212){
df[i,col2] <- 7
}
else if(df[i,col1] >= 213 && df[i,col1] <= 243){
df[i,col2] <- 8
}
else if(df[i,col1] >= 244 && df[i,col1] <= 273){
df[i,col2] <- 9
}
else if(df[i,col1] >= 274 && df[i,col1] <= 304){
df[i,col2] <- 10
}
else if(df[i,col1] >= 305 && df[i,col1] <= 334){
df[i,col2] <- 11
}
else if(df[i,col1] >= 335){
df[i,col2] <- 12
}
}
return(df)
}
df <- cat_day(df,"min_day","cat_min")
df <- cat_day(df,"max_day","cat_max")
df$cat_min <- factor(df$cat_min)
df$cat_max <- factor(df$cat_max)
category_colors <- c("red", "blue", "green", "orange", "purple", "pink",
"black","gray","brown","yellow",
"darkblue","cyan","magenta")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = cat_min)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = cat_max)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
grid <- grid_points(0.75)
preds <- station_grid_points(df,grid,"min_day")
preds["cat_min"] <- rep(NA,dim(preds)[1])
preds$AVERAGE <- round(preds$AVERAGE)
preds <- cat_day(preds,"AVERAGE","cat_min")
preds$cat_min <- factor(preds$cat_min)
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = cat_min)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
grid <- grid_points(0.75)
preds <- station_grid_points(df,grid,"max_day")
preds["cat_max"] <- rep(NA,dim(preds)[1])
preds$AVERAGE <- round(preds$AVERAGE)
preds <- cat_day(preds,"AVERAGE","cat_max")
preds$cat_min <- factor(preds$cat_max)
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = cat_min)) +
geom_point() +
scale_color_manual(values = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
plot_interpolations(df = df, col1 = df$cat_min)
plot_interpolations(df = df, col1 = df$cat_min, type = 2, cat_color = category_colors)
plot_interpolations(df = df, col1 = df$cat_max, type = 2, cat_color = category_colors)
plot_interpolations(df = preds, col1 = df$cat_min, type = 2, cat_color = category_colors)
plot_interpolations(df = preds, col1 = preds$cat_min, type = 2, cat_color = category_colors)
grid <- grid_points(0.75)
preds <- station_grid_points(df,grid,"min_day")
preds["cat_min"] <- rep(NA,dim(preds)[1])
preds$AVERAGE <- round(preds$AVERAGE)
preds <- cat_day(preds,"AVERAGE","cat_min")
preds$cat_min <- factor(preds$cat_min)
plot_interpolations(df = preds, col1 = preds$cat_min, type = 2, cat_color = category_colors)
grid <- grid_points(0.75)
preds <- station_grid_points(df,grid,"max_day")
preds["cat_max"] <- rep(NA,dim(preds)[1])
preds$AVERAGE <- round(preds$AVERAGE)
preds <- cat_day(preds,"AVERAGE","cat_max")
preds$cat_max <- factor(preds$cat_max)
plot_interpolations(df = preds, col1 = preds$cat_max, type = 2, cat_color = category_colors)
#Problem 5
df <- data.frame(station = c(),trend = c(),p_value = c(), se = c())
for(station in stations){
new_df <- weather_data %>% filter(WBANNO == station)
LONGITUDE <- unique(new_df$LONGITUDE)
LATITUDE <- unique(new_df$LATITUDE)
df <- rbind(df,c(station,LONGITUDE,LATITUDE,
yearly_trend(station_id = station)))
}
colnames(df) <- c("station","LONGITUDE","LATITUDE","trend", "pvalue","se")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend)) +
geom_point() +
scale_color_gradient(low = "lightblue", high = "darkred",
limit = range(df$trend)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = NULL)) +
geom_point() +
scale_color_gradient(low = "lightblue", high = "darkred",
limit = range(df$trend)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradient(low = "lightblue", high = "darkred",
limit = range(df$trend)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
#Problem 3
df <- data.frame(WBANNO = c(), LONGITUDE = c(), LATITUDE = c(), min = c(),
max = c() , min_day = c(), max_day = c())
for(station in stations){
cycle <- yearly_cycle(station)
min <- min(cycle$temp)
max <- max(cycle$temp)
min_day <- which.min(cycle$temp)
max_day <- which.max(cycle$temp)
new_df <- weather_data %>% filter(WBANNO == station)
LONGITUDE <- unique(new_df$LONGITUDE)
LATITUDE <- unique(new_df$LATITUDE)
result <- cbind(station,LONGITUDE,LATITUDE,min,max,min_day,max_day)
df <- rbind(df,result)
}
df["cat_min"] <- rep(NA,dim(df)[1])
df["cat_max"] <- rep(NA, dim(df)[1])
cat_day <- function(df,col1,col2){
for(i in 1:dim(df)[1]){
if(df[i,col1] <= 31){
df[i,col2] <- 1
}
else if(df[i,col1] >= 32 && df[i,col1] <= 59){
df[i,col2] <- 2
}
else if(df[i,col1] >= 60 && df[i,col1] <= 90){
df[i,col2] <- 3
}
else if(df[i,col1] >= 91 && df[i,col1] <= 120){
df[i,col2] <- 4
}
else if(df[i,col1] >= 121 && df[i,col1] <= 151){
df[i,col2] <- 5
}
else if(df[i,col1] >= 152 && df[i,col1] <= 181){
df[i,col2] <- 6
}
else if(df[i,col1] >= 182 && df[i,col1] <= 212){
df[i,col2] <- 7
}
else if(df[i,col1] >= 213 && df[i,col1] <= 243){
df[i,col2] <- 8
}
else if(df[i,col1] >= 244 && df[i,col1] <= 273){
df[i,col2] <- 9
}
else if(df[i,col1] >= 274 && df[i,col1] <= 304){
df[i,col2] <- 10
}
else if(df[i,col1] >= 305 && df[i,col1] <= 334){
df[i,col2] <- 11
}
else if(df[i,col1] >= 335){
df[i,col2] <- 12
}
}
return(df)
}
df <- cat_day(df,"min_day","cat_min")
df <- cat_day(df,"max_day","cat_max")
df$cat_min <- factor(df$cat_min)
df$cat_max <- factor(df$cat_max)
category_colors <- c("red", "blue", "green", "orange", "purple", "pink",
"black","gray","brown","yellow",
"darkblue","cyan","magenta")
plot_interpolations(df = df, col1 = df$cat_min, type = 2, cat_color = category_colors)
plot_interpolations(df = df, col1 = df$cat_max, type = 2, cat_color = category_colors)
grid <- grid_points(0.75)
preds <- station_grid_points(df,grid,"min_day")
preds["cat_min"] <- rep(NA,dim(preds)[1])
preds$AVERAGE <- round(preds$AVERAGE)
preds <- cat_day(preds,"AVERAGE","cat_min")
preds$cat_min <- factor(preds$cat_min)
plot_interpolations(df = preds, col1 = preds$cat_min, type = 2, cat_color = category_colors)
grid <- grid_points(0.75)
preds <- station_grid_points(df,grid,"max_day")
preds["cat_max"] <- rep(NA,dim(preds)[1])
preds$AVERAGE <- round(preds$AVERAGE)
preds <- cat_day(preds,"AVERAGE","cat_max")
preds$cat_max <- factor(preds$cat_max)
plot_interpolations(df = preds, col1 = preds$cat_max, type = 2, cat_color = category_colors)
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradient(rainbow(10),
limit = range(df$trend)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(rainbow(10),
limit = range(df$trend)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(rainbow(10)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(10)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
#Problem 5
df <- data.frame(station = c(),trend = c(),p_value = c(), se = c())
for(station in stations){
new_df <- weather_data %>% filter(WBANNO == station)
LONGITUDE <- unique(new_df$LONGITUDE)
LATITUDE <- unique(new_df$LATITUDE)
df <- rbind(df,c(station,LONGITUDE,LATITUDE,
yearly_trend(station_id = station)))
}
colnames(df) <- c("station","LONGITUDE","LATITUDE","trend", "pvalue","se")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(10)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(10) limit = range(trend)) +
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(10)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = category_colors) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(20)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = range(trend)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
#Problem 5
df <- data.frame(station = c(),trend = c(),p_value = c(), se = c())
for(station in stations){
new_df <- weather_data %>% filter(WBANNO == station)
LONGITUDE <- unique(new_df$LONGITUDE)
LATITUDE <- unique(new_df$LATITUDE)
df <- rbind(df,c(station,LONGITUDE,LATITUDE,
yearly_trend(station_id = station)))
}
colnames(df) <- c("station","LONGITUDE","LATITUDE","trend", "pvalue","se")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = range(trend)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(0,1)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(0,0.05)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(0,0.005)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(-0.01,0.005)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(-0.001,0.005)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
grid <- grid_points(resolution = 0.75)
preds <- station_grid_points(df,grid, param = "trend")
plot_interpolations(df = preds, col1 = preds$AVERAGE)
new_df <- df %>% filter(pvalue <= 0.05)
grid <- grid_points(resolution = 0.75)
preds <- station_grid_points(new_df,grid, param = "trend")
plot_interpolations(df = preds, col1 = preds$AVERAGE)
View(new_df)
new_df <- df %>% filter(pvalue <= 0.05)
grid <- grid_points(resolution = 0.75)
preds <- station_grid_points(new_df,grid, param = "trend")
plot_interpolations(df = preds, col1 = preds$AVERAGE)
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = AVERAGE)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(df,aes(x = LONGITUDE, y = LATITUDE, color = trend, size = pvalue)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(-0.001,0.001)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = AVERAGE)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(-0.001,0.001)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = AVERAGE)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(-0.01,0.001)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = AVERAGE)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(-0.001,0.001)) +
labs(x = "Longitude", y = "Latitude",
color = "Month of Year")
ggplot(preds,aes(x = LONGITUDE, y = LATITUDE, color = AVERAGE)) +
geom_point() +
scale_color_gradientn(colors = rainbow(30), limits = c(-0.001,0.001)) +
labs(x = "Longitude", y = "Latitude",
color = "Trend")
plot_interpolations(df = df, col1 = df$trend, type = 3, cat_color = rainbow(10),size = df$pvalue)
devtools:: load_all()
library(climate)
df <- data.frame(station = c(),trend = c(),p_value = c(), se = c())
for(station in stations){
new_df <- weather_data %>% filter(WBANNO == station)
LONGITUDE <- unique(new_df$LONGITUDE)
LATITUDE <- unique(new_df$LATITUDE)
df <- rbind(df,c(station,LONGITUDE,LATITUDE,
yearly_trend(station_id = station)))
}
colnames(df) <- c("station","LONGITUDE","LATITUDE","trend", "pvalue","se")
plot_interpolations(df = df, col1 = df$trend, type = 3, cat_color = rainbow(10),size = df$pvalue)
new_df <- df %>% filter(pvalue <= 0.05)
grid <- grid_points(resolution = 0.75)
preds <- station_grid_points(new_df,grid, param = "trend")
plot_interpolations(df = preds, col1 = preds$trend, type = 3, cat_color = rainbow(10))
devtools:: load_all()
library(climate)
new_df <- df %>% filter(pvalue <= 0.05)
grid <- grid_points(resolution = 0.75)
preds <- station_grid_points(new_df,grid, param = "trend")
plot_interpolations(df = preds, col1 = preds$trend, type = 3, cat_color = rainbow(10))
plot_interpolations(df = preds, col1 = preds$AVERAGE, type = 3, cat_color = rainbow(10))
devtools:: load_all()
library(climate)
plot_interpolations(df = preds, col1 = preds$AVERAGE, type = 3, cat_color = rainbow(10))
devtools:: document()
?yearly_cycle
?weather_data
devtools:: document()
?yearly_cycle
devtools:: document()
?yearly_cycle
devtools:: document()
?station_grid_points
devtools:: document()
?station_grid_points
devtools:: document()
?station_grid_points
